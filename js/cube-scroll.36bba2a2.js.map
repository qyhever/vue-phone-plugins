{"version":3,"sources":["webpack:///./src/views/cube-scroll.vue?20c8","webpack:///./src/mixins/cube-scroll.js","webpack:///src/views/cube-scroll.vue","webpack:///./src/views/cube-scroll.vue?75e3","webpack:///./src/views/cube-scroll.vue","webpack:///./src/views/cube-scroll.vue?5005"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","list","options","on","onPullingDown","onPullingUp","onScroll","_l","item","index","key","onItemClick","_v","_s","directives","name","rawName","value","expression","dissname","onBacktop","staticRenderFns","PULL_UPLOAD","txt","more","noMore","data","pager","page","size","scrollbar","pullDownRefresh","pullUpLoad","allLoaded","backtopOffset","backtopVisible","mounted","query","methods","getInstance","$refs","scrollContainer","scroll","refresh","y","Math","abs","scrollTo","forceUpdate","afterQuery","total","concat","length","mixins","beforeRouteEnter","from","path","next","vm","url","params","$router","push","component"],"mappings":"+IAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,cAAc,CAACG,IAAI,kBAAkBD,YAAY,cAAcE,MAAM,CAAC,KAAOR,EAAIS,KAAK,QAAUT,EAAIU,QAAQ,aAAe,CAAC,WAAWC,GAAG,CAAC,eAAeX,EAAIY,cAAc,aAAaZ,EAAIa,YAAY,OAASb,EAAIc,WAAWd,EAAIe,GAAIf,EAAQ,MAAE,SAASgB,EAAKC,GAAO,OAAOb,EAAG,MAAM,CAACc,IAAID,EAAMX,YAAY,OAAOK,GAAG,CAAC,MAAQX,EAAImB,cAAc,CAACf,EAAG,IAAI,CAACJ,EAAIoB,GAAGpB,EAAIqB,GAAGJ,EAAM,MAAMb,EAAG,MAAM,CAACkB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOT,EAAW,OAAEU,WAAW,gBAAgBpB,YAAY,SAASE,MAAM,CAAC,IAAM,YAAYJ,EAAG,IAAI,CAACJ,EAAIoB,GAAGpB,EAAIqB,GAAGL,EAAKW,kBAAiB,GAAGvB,EAAG,aAAa,CAACI,MAAM,CAAC,KAAO,aAAa,CAACJ,EAAG,MAAM,CAACkB,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOzB,EAAkB,eAAE0B,WAAW,mBAAmBpB,YAAY,WAAWK,GAAG,CAAC,MAAQX,EAAI4B,YAAY,CAACxB,EAAG,MAAM,CAACI,MAAM,CAAC,IAAM,EAAQ,QAAgC,IAAM,kBAAkB,IACp+BqB,EAAkB,G,YCDhBC,EAAc,CAClBC,IAAK,CACHC,KAAM,SACNC,OAAQ,WAGG,GACbC,KADa,WAEX,MAAO,CACLzB,KAAM,GACN0B,MAAO,CACLC,KAAM,EACNC,KAAM,IAER3B,QAAS,CACP4B,WAAW,EACXC,gBAAiB,CACfR,IAAK,QAEPS,WAAYV,GAEdW,WAAW,EACXC,cAAe,IACfC,gBAAgB,IAGpBC,QApBa,WAqBX3C,KAAK4C,SAEPC,QAAS,CACPC,YADO,WAEL,OAAO9C,KAAK+C,MAAMC,gBAAgBC,QAEpCC,QAJO,WAKLlD,KAAK+C,MAAMC,gBAAgBE,WAE7BrC,SAPO,YAOS,IAALsC,EAAK,EAALA,EACTnD,KAAK0C,eAAiBU,KAAKC,IAAIF,IAAMnD,KAAKyC,eAE5Cd,UAVO,WAWL3B,KAAK+C,MAAMC,gBAAgBM,SAAS,EAAG,EAAG,MAG5C3C,cAdO,WAeLX,KAAKwC,WAAY,EACjBxC,KAAKkC,MAAMC,KAAO,EAClBnC,KAAK4C,SAGPhC,YApBO,WAqBDZ,KAAKwC,UACPxC,KAAK+C,MAAMC,gBAAgBO,aAAY,GAAM,IAG/CvD,KAAKkC,MAAMC,MAAQ,EACnBnC,KAAK4C,UAGPA,MA7BO,aAyCPY,WAzCO,SAyCIhD,EAAMiD,GACS,IAApBzD,KAAKkC,MAAMC,KACbnC,KAAKQ,KAAOA,EAEZR,KAAKQ,KAAOR,KAAKQ,KAAKkD,OAAOlD,GAE3BR,KAAKQ,KAAKmD,SAAWF,IACvBzD,KAAKwC,WAAY,EACjBxC,KAAK+C,MAAMC,gBAAgBO,aAAY,GAAM,OCjDrD,GACEjC,KAAM,iBACNsC,OAAQ,CAAC,GACT3B,KAHF,WAII,MAAO,IAET4B,iBANF,SAMA,OACsB,UAAdC,EAAKC,KACPC,GAAK,SAAX,GAEYC,EAAGlB,MAAMC,iBACXiB,EAAGlB,MAAMC,gBAAgBM,SAAS,EAAG,EAAG,MAI5CU,KAGJnB,QAAS,CACPD,MADJ,WACA,WACM,OAAN,OAAM,CAAN,CACQsB,IAAK,kCACLC,OAAQnE,KAAKkC,QACrB,kBACQ,IAAR,aACA,aACA,IAAY,EAAZ,WACU,EAAV,OAEU,EAAV,sBAEY,EAAZ,kBACU,EAAV,aACU,EAAV,8CAIIhB,YAnBJ,WAoBMlB,KAAKoE,QAAQC,KAAK,CAChBN,KAAM,2BCpEuU,I,wBCQjVO,EAAY,eACd,EACAxE,EACA8B,GACA,EACA,KACA,WACA,MAIa,aAAA0C,E,2CCnBf,yBAAyiB,EAAG","file":"js/cube-scroll.36bba2a2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"scroll-wrapper\"},[_c('cube-scroll',{ref:\"scrollContainer\",staticClass:\"cube-scroll\",attrs:{\"data\":_vm.list,\"options\":_vm.options,\"scrollEvents\":['scroll']},on:{\"pulling-down\":_vm.onPullingDown,\"pulling-up\":_vm.onPullingUp,\"scroll\":_vm.onScroll}},_vm._l((_vm.list),function(item,index){return _c('div',{key:index,staticClass:\"item\",on:{\"click\":_vm.onItemClick}},[_c('b',[_vm._v(_vm._s(index+1))]),_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.imgurl),expression:\"item.imgurl\"}],staticClass:\"avatar\",attrs:{\"alt\":\"avatar\"}}),_c('p',[_vm._v(_vm._s(item.dissname))])])}),0),_c('transition',{attrs:{\"name\":\"van-fade\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.backtopVisible),expression:\"backtopVisible\"}],staticClass:\"back-top\",on:{\"click\":_vm.onBacktop}},[_c('img',{attrs:{\"src\":require(\"@/assets/images/back-top.png\"),\"alt\":\"backtop\"}})])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const PULL_UPLOAD = {\r\n  txt: {\r\n    more: '加载中...',\r\n    noMore: '我是有底线的'\r\n  }\r\n}\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [],\r\n      pager: {\r\n        page: 1,\r\n        size: 10\r\n      },\r\n      options: {\r\n        scrollbar: true,\r\n        pullDownRefresh: {\r\n          txt: '更新成功'\r\n        },\r\n        pullUpLoad: PULL_UPLOAD\r\n      },\r\n      allLoaded: false,\r\n      backtopOffset: 1000,\r\n      backtopVisible: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.query()\r\n  },\r\n  methods: {\r\n    getInstance() {\r\n      return this.$refs.scrollContainer.scroll\r\n    },\r\n    refresh() {\r\n      this.$refs.scrollContainer.refresh()\r\n    },\r\n    onScroll({ y }) {\r\n      this.backtopVisible = Math.abs(y) >= this.backtopOffset\r\n    },\r\n    onBacktop() {\r\n      this.$refs.scrollContainer.scrollTo(0, 0, 500)\r\n    },\r\n    // 下拉刷新\r\n    onPullingDown() {\r\n      this.allLoaded = false\r\n      this.pager.page = 1\r\n      this.query()\r\n    },\r\n    // 上拉加载更多\r\n    onPullingUp() {\r\n      if (this.allLoaded) {\r\n        this.$refs.scrollContainer.forceUpdate(true, true)\r\n        return\r\n      }\r\n      this.pager.page += 1\r\n      this.query()\r\n    },\r\n    // 组件内部需要实现 query 查询数据方法\r\n    query() {\r\n      // ...\r\n      // if (!this.firstQuery) {\r\n      //   this.$refs.scrollContainer.disable()\r\n      //   setTimeout(() => {\r\n      //     this.$refs.scrollContainer.enable()\r\n      //   }, 600)\r\n      // }\r\n      // if (this.firstQuery) {\r\n      //   this.firstQuery = false\r\n      // }\r\n    },\r\n    afterQuery(list, total) {\r\n      if (this.pager.page === 1) {\r\n        this.list = list\r\n      } else {\r\n        this.list = this.list.concat(list)\r\n      }\r\n      if (this.list.length === total) {\r\n        this.allLoaded = true\r\n        this.$refs.scrollContainer.forceUpdate(true, true)\r\n      }\r\n    }\r\n  }\r\n}\r\n","<template>\n  <div class=\"scroll-wrapper\">\n    <cube-scroll\n      class=\"cube-scroll\"\n      ref=\"scrollContainer\"\n      :data=\"list\"\n      :options=\"options\"\n      :scrollEvents=\"['scroll']\"\n      @pulling-down=\"onPullingDown\"\n      @pulling-up=\"onPullingUp\"\n      @scroll=\"onScroll\"\n    >\n      <div class=\"item\" v-for=\"(item, index) in list\" :key=\"index\" @click=\"onItemClick\">\n        <b>{{index+1}}</b>\n        <img class=\"avatar\" v-lazy=\"item.imgurl\" alt=\"avatar\">\n        <p>{{item.dissname}}</p>\n      </div>\n    </cube-scroll>\n    <transition name=\"van-fade\">\n      <div v-show=\"backtopVisible\" class=\"back-top\" @click=\"onBacktop\">\n        <img src=\"@/assets/images/back-top.png\" alt=\"backtop\">\n      </div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport request from '@/utils/request'\nimport { cubeScroll } from '@/mixins'\nexport default {\n  name: 'CubeScrollPage',\n  mixins: [cubeScroll],\n  data() {\n    return {}\n  },\n  beforeRouteEnter(to, from, next) {\n    if (from.path === '/home') {\n      next(vm => {\n        // 非详情页进入，返回顶部\n        if (vm.$refs.scrollContainer) {\n          vm.$refs.scrollContainer.scrollTo(0, 0, 0)\n        }\n      })\n    } else {\n      next()\n    }\n  },\n  methods: {\n    query() {\n      request({\n        url: 'https://qyhever.com/common/disc',\n        params: this.pager\n      }).then(data => {\n        const list = data.list || []\n        const total = data.total || 0\n        if (this.pager.page === 1) {\n          this.list = list\n        } else {\n          this.list = this.list.concat(list)\n        }\n        if (this.list.length === total) {\n          this.allLoaded = true\n          this.$refs.scrollContainer.forceUpdate(true, true)\n        }\n      })\n    },\n    onItemClick() {\n      this.$router.push({\n        path: '/cube-scroll-detail'\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .scroll-wrapper {\n    position: fixed;\n    top: 46px;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    transform: rotate(0deg); // fix 子元素超出边框圆角部分不隐藏的问题\n    overflow: hidden;\n    background-color: #fff;\n  }\n  .item {\n    display: flex;\n    align-items: center;\n    padding: 0 20px 20px;\n    background-color: #fff;\n  }\n  .item:first-of-type {\n    padding-top: 20px;\n  }\n  .avatar {\n    width: 60px;\n    height: 60px;\n  }\n  .item b {\n    margin-right: 12px;\n  }\n  .item p {\n    margin-left: 12px;\n  }\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./cube-scroll.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./cube-scroll.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./cube-scroll.vue?vue&type=template&id=9c9033b6&scoped=true&\"\nimport script from \"./cube-scroll.vue?vue&type=script&lang=js&\"\nexport * from \"./cube-scroll.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cube-scroll.vue?vue&type=style&index=0&id=9c9033b6&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9c9033b6\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./cube-scroll.vue?vue&type=style&index=0&id=9c9033b6&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./cube-scroll.vue?vue&type=style&index=0&id=9c9033b6&lang=less&scoped=true&\""],"sourceRoot":""}