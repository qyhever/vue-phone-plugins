{"version":3,"sources":["webpack:///./src/views/mescroll-page.vue?d818","webpack:///./src/views/mescroll-page.vue?ca1e","webpack:///src/views/mescroll-page.vue","webpack:///./src/views/mescroll-page.vue?4e86","webpack:///./src/views/mescroll-page.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","index","key","on","onItemClick","_v","_s","attrs","imgurl","dissname","directives","name","rawName","value","expression","$event","visible","staticRenderFns","data","lastScrollTop","list","params","searchKey","watch","newVal","document","body","classList","add","remove","mounted","initMescroll","beforeDestroy","mescroll","destroy","methods","up","callback","upCallback","htmlNodata","lazyLoad","use","attr","down","mustToTop","fetchData","pager","url","page","size","handleSearch","research","component"],"mappings":"wIAAA,yBAA2iB,EAAG,G,yCCA9iB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAAW,CAACN,EAAIO,GAAIP,EAAQ,MAAE,SAASQ,EAAKC,GAAO,OAAOL,EAAG,MAAM,CAACM,IAAID,EAAMH,YAAY,OAAOK,GAAG,CAAC,MAAQX,EAAIY,cAAc,CAACR,EAAG,IAAI,CAACJ,EAAIa,GAAGb,EAAIc,GAAGL,EAAM,MAAML,EAAG,MAAM,CAACE,YAAY,SAASS,MAAM,CAAC,WAAWP,EAAKQ,OAAO,IAAM,oDAAoD,IAAM,YAAYZ,EAAG,IAAI,CAACJ,EAAIa,GAAGb,EAAIc,GAAGN,EAAKS,kBAAiBb,EAAG,aAAa,CAACW,MAAM,CAAC,KAAO,oBAAoB,CAACX,EAAG,MAAM,CAACc,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOrB,EAAW,QAAEsB,WAAW,YAAYhB,YAAY,SAASK,GAAG,CAAC,MAAQ,SAASY,GAAQvB,EAAIwB,SAAU,SAAa,IACzqBC,EAAkB,G,iCCetB,GACEC,KADF,WAEI,MAAO,CACLC,cAAe,EACfH,SAAS,EACTI,KAAM,GACNC,OAAQ,CACNC,UAAW,MAmBjBC,MAAO,CACLP,QADJ,SACA,GAEUQ,EACFC,SAASC,KAAKC,UAAUC,IAAI,uBAE5BH,SAASC,KAAKC,UAAUE,OAAO,yBAIrCC,QApCF,WAqCIrC,KAAKsC,gBAEPC,cAvCF,WAwCIvC,KAAKwC,UAAYxC,KAAKwC,SAASC,WAEjCC,QAAS,CACPJ,aADJ,WAEUtC,KAAKwC,WAGTxC,KAAKwC,SAAW,IAAI,EAA1B,UACQG,GAAI,CACFC,SAAU5C,KAAK6C,WACfC,WAAY,2CACZC,SAAU,CACRC,KAAK,EACLC,KAAM,aAGVC,KAAM,CACJC,WAAW,OAIjBN,WAnBJ,SAmBA,gBACM7C,KAAKoD,UAAUC,GACrB,kBACQ,IAAR,aACA,aACA,UACU,EAAV,OAEU,EAAV,sBAEQ,EAAR,sBACU,EAAV,4BAGA,mBACQ,QAAR,OACQ,EAAR,aAGID,UAtCJ,SAsCA,OACA,iBACM,OAAO,OAAb,OAAa,CAAb,CACQE,IAAK,kCACL1B,OAAQ,CACN2B,KAAV,EACUC,KAAV,MAII7C,YAhDJ,WAiDMX,KAAKuB,SAAU,GAEjBkC,aAnDJ,WAoDMzD,KAAK4B,OAAOC,UAAY,QACxB7B,KAAKwC,SAASkB,cC/GmU,I,wBCQnVC,EAAY,eACd,EACA7D,EACA0B,GACA,EACA,KACA,WACA,MAIa,aAAAmC,E","file":"js/mescroll-page.fd92a2f1.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mescroll-page.vue?vue&type=style&index=0&id=564ae404&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mescroll-page.vue?vue&type=style&index=0&id=564ae404&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_vm._l((_vm.list),function(item,index){return _c('div',{key:index,staticClass:\"item\",on:{\"click\":_vm.onItemClick}},[_c('b',[_vm._v(_vm._s(index+1))]),_c('img',{staticClass:\"avatar\",attrs:{\"data-src\":item.imgurl,\"src\":\"http://www.mescroll.com/demo/res/img/loading2.gif\",\"alt\":\"avatar\"}}),_c('p',[_vm._v(_vm._s(item.dissname))])])}),_c('transition',{attrs:{\"name\":\"van-slide-right\"}},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.visible),expression:\"visible\"}],staticClass:\"detail\",on:{\"click\":function($event){_vm.visible = false}}})])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"wrapper\">\n    <div class=\"item\" v-for=\"(item, index) in list\" :key=\"index\" @click=\"onItemClick\">\n      <b>{{index+1}}</b>\n      <img class=\"avatar\" :data-src=\"item.imgurl\" src=\"http://www.mescroll.com/demo/res/img/loading2.gif\" alt=\"avatar\">\n      <p>{{item.dissname}}</p>\n    </div>\n    <transition name=\"van-slide-right\">\n      <div class=\"detail\" v-show=\"visible\" @click=\"visible = false\"></div>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport MeScroll from 'mescroll.js'\nimport request from '@/utils/request'\nexport default {\n  data() {\n    return {\n      lastScrollTop: 0, // 路由切换时滚动条的位置\n      visible: false,\n      list: [],\n      params: {\n        searchKey: ''\n      }\n    }\n  },\n  // beforeRouteEnter(to, from, next) {\n  //   next(vm => {\n  //     if (vm.mescroll) {\n  //       if (vm.lastScrollTop) {\n  //         vm.mescroll.setScrollTop(vm.lastScrollTop)\n  //       }\n  //     }\n  //   })\n  // },\n  // beforeRouteLeave(to, from, next) {\n  //   if (this.mescroll) {\n  //     this.lastScrollTop = this.mescroll.getScrollTop() // 记录当前滚动条的位置\n  //   }\n  //   next()\n  // },\n  watch: {\n    visible(newVal) {\n      // hack 滚动穿透\n      if (newVal) {\n        document.body.classList.add('van-overflow-hidden')\n      } else {\n        document.body.classList.remove('van-overflow-hidden')\n      }\n    }\n  },\n  mounted() {\n    this.initMescroll()\n  },\n  beforeDestroy() {\n    this.mescroll && this.mescroll.destroy()\n  },\n  methods: {\n    initMescroll() {\n      if (this.mescroll) {\n        return\n      }\n      this.mescroll = new MeScroll('body', {\n        up: {\n          callback: this.upCallback,\n          htmlNodata: '<p class=\"upwarp-nodata\">-- 已经到底了 --</p>',\n          lazyLoad: {\n            use: true,\n            attr: 'data-src'\n          }\n        },\n        down: {\n          mustToTop: true\n        }\n      })\n    },\n    upCallback(pager, mescroll) {\n      this.fetchData(pager)\n        .then(data => {\n          const list = data.list || []\n          const total = data.total || 0\n          if (pager.num === 1) {\n            this.list = list\n          } else {\n            this.list = this.list.concat(list)\n          }\n          this.$nextTick(() => {\n            mescroll.endBySize(list.length, total)\n          })\n        })\n        .catch(err => {\n          console.log(err)\n          mescroll.endErr()\n        })\n    },\n    fetchData(paper) {\n      const { num: page, size } = paper\n      return request({\n        url: 'https://qyhever.com/common/disc',\n        params: {\n          page,\n          size\n        }\n      })\n    },\n    onItemClick() {\n      this.visible = true\n    },\n    handleSearch() {\n      this.params.searchKey = 'liuli'\n      this.mescroll.research()\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.item {\n  display: flex;\n  align-items: center;\n  padding: 25px 20px 0;\n  background-color: #fff;\n}\n.avatar {\n  width: 40px;\n  height: 40px;\n}\n.item b {\n  margin-right: 12px;\n}\n.item p {\n  margin-left: 12px;\n}\n.detail {\n  z-index: 999;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, .2);\n  transform: translate3d(0, 0, 0);\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mescroll-page.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mescroll-page.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./mescroll-page.vue?vue&type=template&id=564ae404&scoped=true&\"\nimport script from \"./mescroll-page.vue?vue&type=script&lang=js&\"\nexport * from \"./mescroll-page.vue?vue&type=script&lang=js&\"\nimport style0 from \"./mescroll-page.vue?vue&type=style&index=0&id=564ae404&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"564ae404\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}